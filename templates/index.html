<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyWatch PTZ Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="main-container">
        <!-- Main Video Feed (1920x1080) -->
        <div class="video-section">
            <img src="{{ url_for('video_feed') }}" id="video-stream" alt="Video Feed">

            <!-- Video Overlay (Telemetry) -->
            <div class="video-overlay">
                <div class="top-left">
                    <div class="sys-name">AIRPLANE IAN SYSTEMS 401</div>
                    <div id="osd-date">--/--/----</div>
                    <div id="osd-utc">--:--:-- Z</div>
                    <div id="osd-local">--:--:-- LCL</div>
                </div>

                <div class="bottom-left">
                    <div class="status-line">HDEO</div>
                    <div class="status-line">FOC MAN</div>
                    <div class="status-line">EXP AUT</div>
                    <div class="status-line" id="osd-speed">MAX SPD -- (SET)</div>
                    <div class="status-line" id="osd-pid">P=-- I=-- D=--</div>
                </div>

                <div class="center-status">
                    <div id="osd-track-status" class="status-indicator">TRK STBY</div>
                    <div id="osd-stab-status" class="stab-indicator">DSTAB STBY</div>
                </div>

                <!-- PTZ Gauges (Text fallback to match OSD style) -->
                <div class="ptz-readout">
                    <div id="osd-az">AZ: ---</div>
                    <div id="osd-el">EL: ---</div>
                    <div id="osd-zoom">ZM: ---</div>
                </div>

                <!-- WESCAM-style Gauges -->
                <div class="gauges-overlay">
                    <div class="gauges-center-group">
                        <!-- Tilt Gauge -->
                        <div class="gauge-tilt">
                            <svg viewBox="0 0 100 100">
                                <!-- True Arc: Centered at 50,50. Radius 35. -->
                                <!-- Start at 120deg, End at 240deg? No, Vertical arc on left side. -->
                                <!-- Let's say -60 to +60 degrees from horizontal left. -->
                                <!-- SVG Path for arc: M x1 y1 A r r 0 0 1 x2 y2 -->
                                <!-- Center (50,50), Radius 35. -->
                                <!-- Angle ranges: 180 is Left. -->
                                <!-- Top limit (-60 deg = 120 deg on circle? No, 180-60 = 120). -->
                                <!-- Bottom limit (+60 deg = 240 deg). -->
                                <!-- Arc from 120 deg point to 240 deg point. -->
                                <!-- Point 120 deg: x = 50 + 35*cos(120), y = 50 + 35*sin(120) -->
                                <!-- 120 deg rad = 2.094. cos = -0.5, sin = 0.866 -->
                                <!-- x = 50 - 17.5 = 32.5. y = 50 + 30.3 = 80.3 (Wait that's bottom?) -->
                                <!-- Standard SVG coordinates: 0 degrees is Right (East). 90 is Down. 180 is Left. 270 is Up. -->
                                <!-- We want arc on the Left side. So roughly 135 to 225? -->
                                <!-- Let's do 135 (Bottom Left) to 225 (Top Left). -->
                                <!-- Wait, standard math angles: 0 is Right, 90 Up, 180 Left. -->
                                <!-- SVG Y is inverted. 0 Right. 90 DOWN. 180 LEFT. 270 UP. -->
                                <!-- So we want roughly 120 (Bottom-Leftish) to 240 (Top-Leftish). -->
                                <!-- Actually, let's just draw an arc from Angle 210 (Top Left) to 150 (Bottom Left). -->
                                <!-- Let's use a path generator logic mentally or try typical values. -->
                                <!-- Arc from (x1, y1) to (x2, y2). -->
                                <!-- x1, y1 (Top Left, ~210 deg): 50 + 35*cos(210), 50 + 35*sin(210) -->
                                <!-- cos(210) = -0.866, sin(210) = -0.5 -->
                                <!-- x = 19.69, y = 32.5 -->
                                <!-- x2, y2 (Bottom Left, ~150 deg): 50 + 35*cos(150), 50 + 35*sin(150) -->
                                <!-- cos(150) = -0.866, sin(150) = 0.5 -->
                                <!-- x = 19.69, y = 67.5 -->
                                <!-- Let's try simpler: Arc on the left side. -->
                                <path d="M 32.5 19.7 A 35 35 0 0 0 32.5 80.3" fill="none" stroke="white"
                                    stroke-width="3" stroke-linecap="round" />

                                <!-- Center Tick (Neutral/Horizontal) -->
                                <!-- At 180 deg (Left). x=15, y=50. -->
                                <line x1="15" y1="50" x2="25" y2="50" stroke="white" stroke-width="2" />

                                <!-- Needle -->
                                <!-- Pivot at 50,50. Pointing Left (180 deg) at neutral. -->
                                <line id="needle-tilt" x1="50" y1="50" x2="15" y2="50" stroke="white" stroke-width="3"
                                    stroke-linecap="round" />
                            </svg>
                        </div>

                        <!-- Pan Gauge -->
                        <div class="gauge-pan">
                            <svg viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="35" fill="none" stroke="white" stroke-width="3" />
                                <!-- Center Tick (Top/North) -->
                                <line x1="50" y1="15" x2="50" y2="25" stroke="white" stroke-width="2" />

                                <line id="needle-pan" x1="50" y1="50" x2="50" y2="15" stroke="white" stroke-width="3"
                                    stroke-linecap="round" />
                            </svg>
                        </div>
                    </div>

                    <!-- Zoom Gauge -->
                    <div class="gauge-zoom">
                        <span class="label-w">W</span>
                        <svg viewBox="0 0 300 20" preserveAspectRatio="none">
                            <line x1="5" y1="15" x2="295" y2="15" stroke="white" stroke-width="3"
                                stroke-linecap="round" />
                            <!-- Center Tick -->
                            <!-- <line x1="150" y1="10" x2="150" y2="20" stroke="white" stroke-width="1" /> -->
                            <!-- User didn't strictly ask for Zoom tick, but "both gauges" usually implies Circular ones. Zoom is a bar. -->
                            <!-- Triangle Marker -->
                            <polygon id="needle-zoom" points="5,15 10,5 0,5" fill="white" transform="translate(0,0)" />
                        </svg>
                        <span class="label-n">N</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Control Sidebar -->
    <div class="control-sidebar">

        <div class="control-group">
            <label>TRACKING</label>
            <button id="btn-track" class="btn-primary">START AUTO TRACK (SPACE)</button>
        </div>

        <div class="control-group">
            <label>STABILIZATION</label>
            <button id="btn-stab" class="btn-toggle">START DIGITAL STAB (Z)</button>
        </div>

        <div class="control-group">
            <label>RECORDING</label>
            <button id="btn-rec" class="btn-toggle">START RECORDING (`)</button>
        </div>

        <div class="control-group">
            <label>SPEED LIMIT (Q/E)</label>
            <input type="range" id="range-speed" min="0.5" max="24" step="0.5" value="5">
            <span id="val-speed">5.0</span>
        </div>

        <div class="control-group">
            <label>PID TUNING</label>
            <div class="pid-inputs">
                <div class="input-wrap">
                    <span>P (1/2)</span>
                    <input type="number" id="input-p" step="0.01" min="0">
                </div>
                <div class="input-wrap">
                    <span>I (3/4)</span>
                    <input type="number" id="input-i" step="0.01" min="0">
                </div>
                <div class="input-wrap">
                    <span>D (5/6)</span>
                    <input type="number" id="input-d" step="0.01" min="0">
                </div>
                <button id="btn-update-pid" class="btn-action">UPDATE</button>
            </div>
        </div>

        <div class="control-group manual-controls">
            <label>MANUAL JOG</label>
            <div class="dpad">
                <button class="d-btn up" data-key="w">▲</button>
                <button class="d-btn left" data-key="a">◀</button>
                <button class="d-btn center" data-key="space">●</button>
                <button class="d-btn right" data-key="d">▶</button>
                <button class="d-btn down" data-key="s">▼</button>
            </div>
            <div class="zoom-btns">
                <button class="z-btn" data-key="r">ZOOM IN</button>
                <button class="z-btn" data-key="f">ZOOM OUT</button>
            </div>
        </div>
    </div>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>